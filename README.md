# üîê Jenkins Security Library

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Groovy-—Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è Jenkins, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∑–∞–ø—É—Å–∫–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (SAST, DAST, IaC, SCA) –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ DefectDojo.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏  
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã  
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è  
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞  
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ    
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ 

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –≤ Jenkins –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Archive
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π  
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DefectDojo: —Å–æ–∑–¥–∞–Ω–∏–µ engagements, –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π  
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π  
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è  
- –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—É–¥–æ–±–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)  

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (SAST)

- **Semgrep**  
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ (Python, JS, Go, Java –∏ –¥—Ä.)  
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

###  –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–∫ –∫–æ–¥–∞ (IaC)

- **KICS**  
  - –ê–Ω–∞–ª–∏–∑ Terraform, Kubernetes YAML, Dockerfile –∏ CloudFormation 
  - –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ IaC

### –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (SCA)

- **Syft**  
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SBOM 
  - –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- **Grype**  
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ CVE 

###  –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (DAST)

- **OWASP ZAP**  
  - –ü–∞—Å—Å–∏–≤–Ω–æ–µ/–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
  - API-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Nuclei**  
  - –®–∞–±–ª–æ–Ω–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ 
  - –†–∞—Å—à–∏—Ä—è–µ–º—ã–π –Ω–∞–±–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ:

- Jenkins 2.492.2+  
- Docker 20.10+  
- Python 3.8+  
- Go 1.19+  
- Java 17+ (–∏–ª–∏ 21+ —Å –º–∞—Ä—Ç–∞ 2026) 
- Git

### –°–µ—Ç–µ–≤—ã–µ:

- –î–æ—Å—Ç—É–ø –∫ Docker Hub, GitHub, PyPI  
- API-–¥–æ—Å—Ç—É–ø –∫ DefectDojo  

### –ü—Ä–∞–≤–∞:

- –ó–∞–ø—É—Å–∫ Jenkins pipeline –∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤  
- –î–æ—Å—Ç—É–ø –∫ Jenkins Credentials  
- API-–∫–ª—é—á DefectDojo  

##  –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### üîó 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ Jenkins

Jenkins > Manage Jenkins > Configure System > Global Pipeline Libraries:

```yaml
Name: security-library  
Default Version: main  
Retrieval method: Modern SCM  
SCM: Git  
Repository URL: https://your.git.repo  
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# Docker
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update

sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# Python –∏ pip
sudo apt update
sudo apt install python3 python3-pip

# Go (–¥–ª—è Nuclei)
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

#Nuclei Github
git clone https://github.com/projectdiscovery/nuclei.git; \
cd nuclei/cmd/nuclei; \
go build; \
mv nuclei /usr/local/bin/; \
nuclei -version;

# Java
sudo apt install openjdk-17-jdk
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Jenkins –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker jenkins
sudo systemctl restart jenkins
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### DefectDojo

1. –°–æ–∑–¥–∞–Ω–∏–µ API –∫–ª—é—á–∞:
   - –í–æ–π–¥–∏—Ç–µ –≤ DefectDojo
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ API v2 > Credentials
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–ª—é—á

2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ Jenkins:
   - Jenkins > Credentials > System > Global credentials
   - Add Credentials
   - Kind: Secret text
   - Secret: –í–∞—à API –∫–ª—é—á
   - ID: defectdojo-api-key

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Jenkinsfile –ø—Ä–æ–µ–∫—Ç–∞:
   ```groovy
   environment {
       DEFECTDOJO_URL = 'https://your-defectdojo-instance.com'
       DEFECTDOJO_API_KEY = credentials('defectdojo-api-key')
   }
   ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–∞–Ω–µ—Ä–æ–≤

#### Semgrep
```
docker run --rm -v ${sourcePath}:/mnt/source:ro -v ${outputDir}:/mnt/output semgrep/semgrep semgrep --config=auto /mnt/source -o /mnt/output/${outputFile}
```

#### KICS
```
docker run --rm -v ${targetDir}:/path -v ${outputDir}:/reports checkmarx/kics:latest scan -p /path -o /reports/${outputFile}
```
#### Syft and Grype
```
syft ${imageName} -o json > ${outputDir}/${syftOutputFile}
grype sbom:${outputDir}/${syftOutputFile} -o json > ${outputDir}/${grypeOutputFile}
```

#### Nuclei
```
docker run --rm -v ${outputDir}:/output projectdiscovery/nuclei:latest \
        -u ${targetUrl} -o /output/${outputFile} -j
```
#### OWASP ZAP
```
docker run --rm -v ${outputDir}:/zap/wrk/ -t zaproxy/zap-stable \
        zap.sh -cmd -quickurl ${targetUrl} -quickout /zap/wrk/${outputFile}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

1. –î–æ–±–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –≤–∞—à Jenkinsfile:
   ```groovy
   @Library('security-library') _
   ```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```groovy
   environment {
       HOMEDIR = ''
       WORKSPACE = ''
       DEFECTDOJO_URL = 'https://your-defectdojo-instance.com'
       DEFECTDOJO_API_KEY = credentials('defectdojo-api-key')
   }
   ```

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ pipeline:

```groovy
stage('Semgrep Scan') {
    steps {
        runSemgrepScan(SOURCE_PATH, 'semgrep_report.json', HOME_DIR, WORKSPACE_PATH)
    }
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Pipeline Script from SCM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ - —ç—Ç–æ Pipeline Script from SCM:

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `Jenkinsfile` –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
   ```groovy
   @Library('security-library') _
   
   pipeline {
       agent any
       
       environment {
           DEFECTDOJO_URL = 'https://your-defectdojo-instance.com'
           DEFECTDOJO_API_KEY = credentials('defectdojo-api-key')
       }
       
       stages {
           stage('Security Scan') {
               steps {
                   script {
                       // –í–∞—à–∏ —à–∞–≥–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                   }
               }
           }
       }
   }
   ```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ pipeline –≤ Jenkins:
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Pipeline job
   - –í —Å–µ–∫—Ü–∏–∏ "Pipeline" –≤—ã–±–µ—Ä–∏—Ç–µ "Pipeline script from SCM"
   - –£–∫–∞–∂–∏—Ç–µ:
     - SCM: Git
     - Repository URL: URL –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
     - Credentials: –µ—Å–ª–∏ —Ç—Ä–µ–±—É—é—Ç—Å—è
     - Branch Specifier: */main (–∏–ª–∏ –≤–∞—à—É –≤–µ—Ç–∫—É)
     - Script Path: Jenkinsfile

3. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
   - Jenkinsfile —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π pipeline –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∫–æ–¥–æ–º
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å code review –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ pipeline
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫–∞–Ω–µ—Ä—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:

```groovy
stage('Security Scan') {
    steps {
        script {
            parallel(
                "SAST": {
                    runSemgrepScan(...)
                },
                "IaC": {
                    runKICSScan(...)
                },
                "DAST": {
                    runNucleiScan(...)
                }
            )
        }
    }
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- üìÅ `scripts/uploader/`
  - `defectdojo_uploader.py` ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ DefectDojo.
  - `Dockerfile` ‚Äî –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞.

- üìÅ `src/org/security/scanners/`
  - (–ø—É—Å—Ç–æ) ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ —Å–∫–∞–Ω–µ—Ä–æ–≤.

- üìÅ `vars/`
  - `runKICSScan.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ KICS.
  - `runNucleiScan.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ Nuclei.
  - `runSCAScan.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (SCA).
  - `runSemgrepScan.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ Semgrep.
  - `runZAPScan.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞ OWASP ZAP.
  - `uploadToDefectDojo.groovy` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ –≤ DefectDojo. (–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø)
